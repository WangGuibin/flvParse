# FLV 解析工具

## 1. 项目简介

本项目是一个使用 Python 和 Tkinter 开发的图形用户界面（GUI）工具，专门用于深度解析 FLV (Flash Video) 文件。

**核心功能包括:**

- **结构化展示**: 以树状视图清晰地展示 FLV 文件的内部结构，包括文件头（Header）和各类标签（Tag），如音频、视频和脚本数据。
- **元数据解析**: 自动解析 `onMetaData` 脚本标签，提取视频的宽高、帧率、码率等关键元数据信息。
- **时间戳分析**: 智能分析音频和视频标签的时间戳，检测时间戳的异常跳跃，帮助定位潜在的推流丢帧、网络抖动或编码器问题。
- **音视频分离**: 集成 FFmpeg，提供一键分离 FLV 文件中的音频流和视频流的功能，并将它们分别保存为 `.aac` 和 `.mp4` 文件。

该工具为多媒体开发者、视频工程师和技术支持人员提供了一个直观、高效的方式来诊断和分析 FLV 文件问题。

## 2. 文件结构

项目根目录包含以下关键文件和文件夹：

- **`flv_parser.py`**: 项目的主程序文件，包含了 GUI 界面和所有解析逻辑的 Python 脚本。
- **`build.py`**: 自动化构建脚本。运行此脚本可以为当前操作系统（macOS 或 Windows）打包生成可分发的应用程序。
- **`requirements.txt`**: 定义了项目构建时所需的 Python 依赖库（主要是 `pyinstaller`）。
- **`flv_parser.spec`**: `PyInstaller` 的配置文件，用于指导打包过程，例如指定应用图标、包含的数据文件等。
- **`packaging_plan.md`**: 一份详细的文档，阐述了项目的跨平台打包策略和技术选型。
- **`dist/`**: (构建后生成) 此目录用于存放构建成功后的最终分发产物。
- **`build/`**: (构建后生成) `PyInstaller` 在打包过程中产生的临时工作目录。

## 3. 构建说明

你可以通过运行自动化脚本来为 macOS 和 Windows 构建独立的安装包。

**重要提示**: Windows 的安装包必须在 Windows 环境下构建，macOS 的安装包必须在 macOS 环境下构建。

### 步骤 1: 安装依赖

在开始构建之前，首先需要安装项目所需的 Python 依赖库。在项目根目录下打开终端，运行以下命令：

```bash
pip install -r requirements.txt
```

_在 macOS 上，你可能还需要安装 `create-dmg` 工具用于创建 `.dmg` 安装包:_

```bash
brew install create-dmg
```

### 步骤 2: 运行构建脚本

安装完依赖后，只需运行 `build.py` 脚本即可启动自动化构建流程：

```bash
python build.py
```

该脚本会自动检测你当前的操作系统，并执行相应的打包命令。

- 在 **macOS** 上，它会先使用 `PyInstaller` 创建一个 `.app` 应用，然后调用 `create-dmg` 将其打包成一个 `.dmg` 磁盘映像文件。
- 在 **Windows** 上，它会使用 `PyInstaller` 创建一个包含 `.exe` 可执行文件和所有依赖的文件夹。

## 4. 分发产物

构建过程成功结束后，所有可分发的安装包都将位于项目根目录下的 `dist/` 文件夹中。

- **macOS**: 你会找到一个名为 `FLVParser-Installer.dmg` 的文件。用户可以像安装其他 Mac 应用一样，双击打开并将其拖入“应用程序”文件夹。
- **Windows**: 你会找到一个名为 `FLVParser` 的文件夹。整个文件夹就是可执行程序，用户可以直接打开此文件夹并双击 `FLVParser.exe` 来运行程序。
